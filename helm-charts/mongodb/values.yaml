image:
  repository: robotshopacr.azurecr.io/mongodb  # Move to ACR for security scanning
  tag: "v20251227-a94e952"  # Fixed MongoDB user creation script
  pullPolicy: Always

# Enable authentication
auth:
  enabled: true
  rootUser: admin
  rootPassword: ""  # Retrieved from Azure Key Vault
  # Database-specific users
  databases:
    - name: catalogue
      username: catalogue
      password: ""  # Retrieved from Azure Key Vault
    - name: users  
      username: users
      password: ""  # Retrieved from Azure Key Vault

# Add persistence
persistence:
  enabled: true
  storageClass: "managed-csi"
  size: 20Gi
  accessMode: ReadWriteOnce

# Security context
securityContext:
  runAsNonRoot: true
  runAsUser: 999
  fsGroup: 999

# Resource limits
resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

# Azure Key Vault integration (following MySQL pattern)
keyVault:
  enabled: true
  secretProviderClass: mongodb-secrets

# Vertical Pod Autoscaler
vpa:
  enabled: false
  updateMode: "Off"  # Recommendations only for databases
  minCpu: "10m"
  maxCpu: "500m"
  minMemory: "64Mi"
  maxMemory: "1Gi"

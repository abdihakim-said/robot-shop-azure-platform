# Environment-specific overrides for dev
cluster-autoscaler:
  # AKS-specific configuration
  cloudProvider: azure
  azureResourceGroup: robot-shop-dev-rg
  azureClusterName: robot-shop-dev-aks
  
  # Dev environment scaling
  autoscalingGroups:
    - name: agentpool
      minSize: 2  # Minimum for HA
      maxSize: 6  # Allow scaling for HPA workloads
  
  # Faster scaling for dev environment
  scaleDownDelayAfterAdd: "5m"    # Faster scale down in dev
  scaleDownUnneededTime: "5m"     # Quicker cleanup in dev
  scaleDownUtilizationThreshold: 0.3  # More aggressive scaling in dev
  
  # Dev-specific resource limits
  resources:
    requests:
      cpu: 50m      # Lower resource usage in dev
      memory: 200Mi
    limits:
      cpu: 100m
      memory: 300Mi
  
  # Dev logging (more verbose)
  verbosity: 6
  
  # Fix: Proper extraArgs structure
  extraArgs:
    balance-similar-node-groups: true
    skip-nodes-with-local-storage: false
    skip-nodes-with-system-pods: false
    scale-down-enabled: true
    scale-down-delay-after-add: 5m
    scale-down-unneeded-time: 5m
    max-node-provision-time: 10m
    expander: "least-waste"  # Fix: Add required expander field
    node-group-auto-discovery: "asg:tag=k8s.io/cluster-autoscaler/enabled,k8s.io/cluster-autoscaler/robot-shop-dev-aks"
